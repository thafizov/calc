(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{518:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profitability",function(){return a(3835)}])},8415:function(e,t,a){"use strict";var l=a(5893);a(7294);var n=a(2075),o=a(1396);t.Z=e=>{let{children:t}=e;return(0,l.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,l.jsx)(n.Z,{hasScaling:!0}),(0,l.jsx)("main",{className:"flex-grow pt-16",children:t}),(0,l.jsx)(o.Z,{hasScaling:!0})]})}},3835:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ProfitabilityPage}});var l=a(5893),n=a(7294),o=a(9008),i=a.n(o),r=a(5675),s=a.n(r),c=a(8415),d=a(5379),p=a.n(d),u=a(1988),x=a(6627),m=a.n(x);a(5890);var h=a(7744);(0,u.I2)("ru",h.Z);var components_DateRangePicker=e=>{let{startDate:t,endDate:a,onChange:o,placeholder:i="мм.гг — мм.гг",className:r="",error:c}=e,[d,x]=(0,n.useState)(""),[h,g]=(0,n.useState)(!1),f=(0,n.useRef)(null);(0,n.useEffect)(()=>{function handleClickOutside(e){f.current&&!f.current.contains(e.target)&&g(!1)}return document.addEventListener("mousedown",handleClickOutside),()=>{document.removeEventListener("mousedown",handleClickOutside)}},[]);let formatDateToMonthYear=e=>{let t=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getFullYear().toString().slice(-2);return"".concat(t,".").concat(a)};(0,n.useEffect)(()=>{if(t&&a){let e=formatDateToMonthYear(t),l=formatDateToMonthYear(a);x("".concat(e," — ").concat(l))}else if(t){let e=formatDateToMonthYear(t);x("".concat(e," — __.__"))}else if(a){let e=formatDateToMonthYear(a);x("__.__ — ".concat(e))}else x("")},[t,a]);let parseDateRange=e=>{if(!e.includes(" — "))return[null,null];let[t,a]=e.split(" — "),parseMonthYear=e=>{if("__.__"===e||5!==e.length||e.includes("_"))return null;let[t,a]=e.split("."),l=parseInt(a)+2e3,n=new Date(l,parseInt(t)-1,1);return n.getMonth()===parseInt(t)-1&&n.getFullYear()===l&&parseInt(t)>=1&&12>=parseInt(t)?n:null},l=parseMonthYear(t),n=parseMonthYear(a);return n&&n.setMonth(n.getMonth()+1,0),[l,n]};return(0,l.jsxs)("div",{ref:f,className:"jsx-7d95323ef4ad4f3f relative",children:[(0,l.jsxs)("div",{className:"jsx-7d95323ef4ad4f3f relative",children:[(0,l.jsx)(m(),{mask:"99.99 — 99.99",value:d,onChange:e=>{let t=e.target.value;if(x(t),11===t.length&&!t.includes("_")){let[e,a]=parseDateRange(t);(e||a)&&o(e,a)}(""===t||"__.__ — __.__"===t)&&o(null,null)},placeholder:i,className:"w-full h-[60px] pl-10 pr-[120px] rounded-[30px] bg-[#E9F5FF] border-0 focus:ring-2 focus:ring-accent-blue text-[22px] ".concat(r),maskChar:"_"}),(0,l.jsx)("div",{className:"jsx-7d95323ef4ad4f3f absolute right-0 inset-y-0 flex items-center",children:(0,l.jsx)("button",{type:"button",onClick:()=>g(!h),className:"jsx-7d95323ef4ad4f3f h-[60px] w-[90px] rounded-[30px] bg-[#CEE1F0] flex items-center justify-center cursor-pointer",children:(0,l.jsx)(s(),{src:"/img/date.svg",alt:"Календарь",width:24,height:24})})})]}),h&&(0,l.jsx)("div",{className:"jsx-7d95323ef4ad4f3f absolute z-10 bg-white rounded-[15px] border border-gray-200 shadow-lg p-2 calendar-dropdown",children:(0,l.jsxs)("div",{className:"jsx-7d95323ef4ad4f3f flex flex-col gap-2 calendar-container",children:[(0,l.jsxs)("div",{className:"jsx-7d95323ef4ad4f3f flex flex-col items-center",children:[(0,l.jsx)("h4",{className:"jsx-7d95323ef4ad4f3f text-xs font-medium text-gray-700 mb-1 calendar-title",children:"Начальная дата"}),(0,l.jsx)(u.ZP,{selected:t,onChange:e=>{o(e,a)},locale:"ru",inline:!0,showMonthYearPicker:!0,dateFormat:"MM/yyyy",maxDate:a||void 0})]}),(0,l.jsxs)("div",{className:"jsx-7d95323ef4ad4f3f flex flex-col items-center",children:[(0,l.jsx)("h4",{className:"jsx-7d95323ef4ad4f3f text-xs font-medium text-gray-700 mb-1 calendar-title",children:"Конечная дата"}),(0,l.jsx)(u.ZP,{selected:a,onChange:e=>{let a=e;e&&(a=new Date(e.getFullYear(),e.getMonth()+1,0)),o(t,a),a&&t&&g(!1)},locale:"ru",inline:!0,showMonthYearPicker:!0,dateFormat:"MM/yyyy",minDate:t||void 0})]})]})}),(0,l.jsx)(p(),{id:"7d95323ef4ad4f3f",children:".calendar-dropdown{padding:8px;right:0;top:100%;margin-top:8px}.calendar-container{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:8px}.calendar-title{font-size:12px;margin-bottom:4px}.react-datepicker{font-family:inherit;border:none;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none}.react-datepicker__header{background:white;border-bottom:1px solid#e5e7eb;-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;padding-top:6px}.react-datepicker__current-month{font-size:12px;font-weight:500;color:#111827;text-transform:capitalize;margin-bottom:3px}.react-datepicker__month-container{width:150px}.react-datepicker__month .react-datepicker__month-text,.react-datepicker__month .react-datepicker__quarter-text{display:inline-block;width:2rem;margin:1px;height:24px;line-height:24px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;text-align:center;cursor:pointer;font-size:10px;color:#111827}.react-datepicker__month .react-datepicker__month-text:hover,.react-datepicker__month .react-datepicker__quarter-text:hover{background-color:#f3f4f6}.react-datepicker__month .react-datepicker__month-text--selected,.react-datepicker__month .react-datepicker__quarter-text--selected{background-color:#3b82f6;color:white}.react-datepicker__month .react-datepicker__month-text--disabled,.react-datepicker__month .react-datepicker__quarter-text--disabled{color:#d1d5db;cursor:not-allowed}.react-datepicker__year-text{display:inline-block;width:2rem;margin:1px;height:24px;line-height:24px;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;text-align:center;cursor:pointer;font-size:10px;color:#111827}.react-datepicker__year-text:hover{background-color:#f3f4f6}.react-datepicker__year-text--selected{background-color:#3b82f6;color:white}.react-datepicker__navigation{top:6px;line-height:1.7rem;border:none;background:none}.react-datepicker__navigation--previous{left:8px;border:none}.react-datepicker__navigation--next{right:8px;border:none}.react-datepicker__navigation:hover .react-datepicker__navigation--previous{border:none}.react-datepicker__navigation:hover .react-datepicker__navigation--next{border:none}@media(min-width:480px){.calendar-container{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;gap:16px}}@media(min-width:960px){.calendar-dropdown{padding:20px}.calendar-container{gap:32px}.calendar-title{font-size:16px;margin-bottom:10px}.react-datepicker__header{padding-top:12px}.react-datepicker__current-month{font-size:16px;margin-bottom:8px}.react-datepicker__month-container{width:240px}.react-datepicker__month .react-datepicker__month-text,.react-datepicker__month .react-datepicker__quarter-text{width:3.5rem;margin:3px;height:32px;line-height:32px;font-size:14px}.react-datepicker__year-text{width:3.5rem;margin:3px;height:32px;line-height:32px;font-size:14px}.react-datepicker__navigation{top:10px}}"})]})},g=a(623),f=a(9081),b=a(7349);let D=[{value:!1,label:"Нет"},{value:!0,label:"Да"}];var components_InflationSelect=e=>{let{value:t,onChange:a}=e,o=D.find(e=>e.value===t)||D[0];return(0,l.jsx)(g.Ri,{value:o,onChange:e=>a(e.value),children:(0,l.jsxs)("div",{className:"relative h-[60px]",children:[(0,l.jsxs)(g.Ri.Button,{className:"w-full h-full bg-[#E9F5FF] rounded-[30px] flex items-center pl-10 pr-24 transition-colors cursor-pointer focus:ring-2 focus:ring-accent-blue relative",children:[(0,l.jsx)("span",{className:"block truncate text-left text-[22px] flex-1",children:o.label}),(0,l.jsx)("div",{className:"absolute right-0 top-0 w-[80px] h-[60px] bg-[#CEE1F0] rounded-[30px] flex items-center justify-center transition-colors hover:bg-[#B8D0E8] pointer-events-none",children:(0,l.jsx)(b.Z,{className:"h-5 w-5 text-[#96A8D4]","aria-hidden":"true"})})]}),(0,l.jsx)(f.u,{as:n.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)(g.Ri.Options,{className:"absolute left-0 right-0 z-10 mt-2 overflow-hidden rounded-[15px] bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:D.map(e=>(0,l.jsx)(g.Ri.Option,{className:e=>{let{active:t}=e;return"relative cursor-pointer select-none py-3 pl-10 pr-4 ".concat(t?"bg-[#E9F5FF] text-accent-blue":"text-gray-900")},value:e,children:t=>{let{selected:a}=t;return(0,l.jsx)("span",{className:"block truncate text-[18px] ".concat(a?"font-medium text-accent-blue":"font-normal"),children:e.label})}},e.value.toString()))})})]})})};let v=[{value:"less_than_1_year",label:"Менее 1 года"},{value:"1_to_3_years",label:"1-3 года"},{value:"more_than_3_years",label:"Более 3 лет"}];var components_DepositTermSelect=e=>{let{value:t,onChange:a,disabled:o=!1}=e,i=v.find(e=>e.value===t)||v[0];return(0,l.jsx)(g.Ri,{value:i,onChange:e=>a(e.value),disabled:o,children:(0,l.jsxs)("div",{className:"relative h-[60px]",children:[(0,l.jsxs)(g.Ri.Button,{className:"w-full h-full rounded-[30px] flex items-center pl-10 pr-24 transition-colors relative ".concat(o?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-[#E9F5FF] cursor-pointer focus:ring-2 focus:ring-accent-blue"),children:[(0,l.jsx)("span",{className:"block truncate text-left text-[22px] flex-1",children:i.label}),(0,l.jsx)("div",{className:"absolute right-0 top-0 w-[80px] h-[60px] rounded-[30px] flex items-center justify-center transition-colors pointer-events-none ".concat(o?"bg-gray-200":"bg-[#CEE1F0] hover:bg-[#B8D0E8]"),children:(0,l.jsx)(b.Z,{className:"h-5 w-5 ".concat(o?"text-gray-300":"text-[#96A8D4]"),"aria-hidden":"true"})})]}),!o&&(0,l.jsx)(f.u,{as:n.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)(g.Ri.Options,{className:"absolute left-0 right-0 z-10 mt-2 overflow-hidden rounded-[15px] bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:v.map(e=>(0,l.jsx)(g.Ri.Option,{className:e=>{let{active:t}=e;return"relative cursor-pointer select-none py-3 pl-10 pr-4 ".concat(t?"bg-[#E9F5FF] text-accent-blue":"text-gray-900")},value:e,children:t=>{let{selected:a}=t;return(0,l.jsx)("span",{className:"block truncate text-[18px] ".concat(a?"font-medium text-accent-blue":"font-normal"),children:e.label})}},e.value))})})]})})};let y=[{value:"ofz",label:"ОФЗ"},{value:"corporate",label:"Корпоративные"}];var components_BondTypeSelect=e=>{let{value:t,onChange:a,disabled:o=!1}=e,i=y.find(e=>e.value===t)||y[0];return(0,l.jsx)(g.Ri,{value:i,onChange:e=>a(e.value),disabled:o,children:(0,l.jsxs)("div",{className:"relative h-[60px]",children:[(0,l.jsxs)(g.Ri.Button,{className:"w-full h-full rounded-[30px] flex items-center pl-10 pr-24 transition-colors relative ".concat(o?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-[#E9F5FF] cursor-pointer focus:ring-2 focus:ring-accent-blue"),children:[(0,l.jsx)("span",{className:"block truncate text-left text-[22px] flex-1",children:i.label}),(0,l.jsx)("div",{className:"absolute right-0 top-0 w-[80px] h-[60px] rounded-[30px] flex items-center justify-center transition-colors pointer-events-none ".concat(o?"bg-gray-200":"bg-[#CEE1F0] hover:bg-[#B8D0E8]"),children:(0,l.jsx)(b.Z,{className:"h-5 w-5 ".concat(o?"text-gray-300":"text-[#96A8D4]"),"aria-hidden":"true"})})]}),!o&&(0,l.jsx)(f.u,{as:n.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)(g.Ri.Options,{className:"absolute left-0 right-0 z-10 mt-2 overflow-hidden rounded-[15px] bg-white py-1 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:y.map(e=>(0,l.jsx)(g.Ri.Option,{className:e=>{let{active:t}=e;return"relative cursor-pointer select-none py-3 pl-10 pr-4 ".concat(t?"bg-[#E9F5FF] text-accent-blue":"text-gray-900")},value:e,children:t=>{let{selected:a}=t;return(0,l.jsx)("span",{className:"block truncate text-[18px] ".concat(a?"font-medium text-accent-blue":"font-normal"),children:e.label})}},e.value))})})]})})},components_CustomCheckbox=e=>{let{checked:t,onChange:a,label:n,className:o=""}=e;return(0,l.jsxs)("div",{className:"relative flex h-[60px] cursor-pointer transition-all duration-200 ".concat(o),onClick:()=>a(!t),children:[(0,l.jsx)("div",{className:"w-full bg-[#E9F5FF] rounded-[30px] flex items-center pl-10 pr-24",children:(0,l.jsx)("span",{className:"text-[22px] text-gray-900",children:n})}),(0,l.jsx)("div",{className:"absolute right-0 top-0 w-[80px] h-[60px] bg-[#CEE1F0] rounded-[30px] flex items-center justify-center",children:(0,l.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"transition-all duration-200",children:(0,l.jsx)("path",{d:"M12 0C5.376 0 0 5.376 0 12C0 18.624 5.376 24 12 24C18.624 24 24 18.624 24 12C24 5.376 18.624 0 12 0ZM9.6 18L3.6 12L5.292 10.308L9.6 14.604L18.708 5.496L20.4 7.2L9.6 18Z",fill:t?"#486FCF":"#FFFFFF"})})})]})},j=a(9009),_=a(5351),w=a(4195),k=a(827),N=a(3023),C=a(5358),F=a(6050),S=a(3558),A=a(6880);let E={Депозит:"#2563EB",Облигации:"#EA580C",Акции:"#16A34A"},formatMonth=e=>{let[t,a]=e.split("-");return"".concat(["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"][parseInt(a)-1]," ").concat(t)},getXAxisInterval=e=>e<=12?0:e<=24?2:e<=60?5:11,CustomTooltip=e=>{let{active:t,payload:a,label:n}=e;return t&&a&&a.length?(0,l.jsxs)("div",{className:"bg-white p-2 md:p-4 rounded-lg shadow-lg border max-w-[200px] md:max-w-none text-xs md:text-sm",children:[(0,l.jsx)("p",{className:"font-semibold text-gray-900 text-xs md:text-sm mb-1",children:formatMonth(n)}),a.map((e,t)=>{let a=e.dataKey.includes("_inflation"),n=e.dataKey.replace("_inflation","");return(0,l.jsx)("p",{style:{color:e.color},className:"text-xs md:text-sm leading-tight",children:"".concat(a?"".concat(n," (с учетом инфляции)"):n,": ").concat(e.value.toFixed(2),"%")},t)})]}):null};var components_ProfitabilityChart=e=>{let{results:t,monthlyChartData:a,inflationEnabled:o,startDate:i,endDate:r}=e;if(0===a.length)return null;let s=getXAxisInterval(a.length);return(0,l.jsx)("div",{className:"bg-white rounded-[30px] shadow-lg max-w-container mx-auto",children:(0,l.jsxs)("div",{className:"max-w-container mx-auto px-3 md:px-6 lg:px-9 laptop:px-[60px] py-6 md:py-8 lg:py-6 laptop:py-[30px]",children:[(0,l.jsx)("h3",{className:"text-[20px] md:text-[24px] font-semibold text-gray-900 mb-4 md:mb-6 text-center",children:"График доходности инвестиций"}),o&&(0,l.jsxs)("div",{className:"flex justify-center items-center gap-4 md:gap-6 mb-4 md:mb-6 text-xs md:text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 md:w-6 h-0.5 bg-gray-400"}),(0,l.jsx)("span",{className:"text-gray-600",children:"Без учета инфляции"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 md:w-6 h-0.5 border-t-2 border-dashed border-gray-400"}),(0,l.jsx)("span",{className:"text-gray-600",children:"С учетом инфляции"})]})]}),(0,l.jsx)("div",{className:"h-[300px] md:h-[400px] w-full",children:(0,l.jsx)(j.h,{width:"100%",height:"100%",children:(0,l.jsxs)(_.w,{data:a,margin:{top:10,right:10,left:-20,bottom:40},children:[(0,l.jsx)(w.q,{strokeDasharray:"3 3",stroke:"#E5E7EB"}),(0,l.jsx)(k.d,{y:0,stroke:"#9CA3AF",strokeDasharray:"2 2",strokeWidth:1}),(0,l.jsx)(N.K,{dataKey:"month",stroke:"#6B7280",fontSize:12,tickLine:!1,axisLine:!1,interval:s,tickFormatter:e=>{let[t,a]=e.split("-");return"".concat(a,"/").concat(t.slice(2))}}),(0,l.jsx)(C.B,{stroke:"#6B7280",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:e=>"".concat(e,"%")}),(0,l.jsx)(F.u,{content:(0,l.jsx)(CustomTooltip,{})}),(0,l.jsx)(S.D,{verticalAlign:"bottom",height:36,wrapperStyle:{paddingTop:"20px",fontSize:"12px"},content:e=>{let{payload:t}=e,a=null==t?void 0:t.filter(e=>!e.dataKey.includes("_inflation"));return(0,l.jsx)("div",{className:"flex justify-center items-center gap-3 md:gap-6 text-xs md:text-sm",children:null==a?void 0:a.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center gap-1 md:gap-2",children:[(0,l.jsx)("div",{className:"w-4 md:w-6 h-0.5",style:{backgroundColor:e.color}}),(0,l.jsx)("span",{style:{color:e.color},className:"font-medium",children:e.value})]},t))})}}),t.map(e=>{let t=e.instrument,a=E[t]||"#6B7280";return(0,l.jsxs)(n.Fragment,{children:[(0,l.jsx)(A.x,{type:"monotone",dataKey:t,stroke:a,strokeWidth:2,dot:!1,activeDot:{r:4,fill:a},connectNulls:!1}),o&&void 0!==e.inflationAdjustedProfit&&(0,l.jsx)(A.x,{type:"monotone",dataKey:"".concat(t,"_inflation"),stroke:a,strokeWidth:2,strokeDasharray:"4 2",dot:!1,activeDot:{r:4,fill:a},connectNulls:!1})]},t)})]})})}),(0,l.jsx)("div",{className:"text-center",children:(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"* График показывает историческую доходность. Прошлые результаты не гарантируют будущей прибыльности."})})]})})};let P=null,loadData=async()=>{if(P)return P;try{let e=await fetch("./data/all_data_final.json");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return P=await e.json()}catch(e){throw console.error("Error loading data:",e),e}},findToolByCode=(e,t)=>{for(let a of e.tools){if(a.code===t)return a;if(a.items&&a.items.length>0&&"code"in a.items[0])for(let e of a.items){if(e.code===t)return e;if(e.items&&e.items.length>0&&"code"in e.items[0]){for(let a of e.items)if(a.code===t)return a}}}return null},filterDataByDates=(e,t,a)=>{var l,n;let o=new Date(t),i=new Date(a);console.log("\uD83D\uDDD3️ Filtering data by dates:",{startDate:t,endDate:a,totalItems:e.length}),console.log("\uD83D\uDDD3️ Start/End objects:",{start:o.toISOString(),end:i.toISOString()});let r=e.filter((t,a)=>{let l=new Date(t.date.split(".").reverse().join("-")),n=l>=o&&l<=i;return(a<5||a>=e.length-5)&&console.log("\uD83D\uDDD3️ ".concat(t.date," -> ").concat(l.toISOString().split("T")[0],": ").concat(n?"INCLUDED":"EXCLUDED")),n});return console.log("\uD83D\uDDD3️ Filtered result:",{filteredItems:r.length,firstDate:null===(l=r[0])||void 0===l?void 0:l.date,lastDate:null===(n=r[r.length-1])||void 0===n?void 0:n.date,firstFewDates:r.slice(0,3).map(e=>e.date),lastFewDates:r.slice(-3).map(e=>e.date)}),r},fetchProfitabilityData=async e=>{try{let{startDate:t,endDate:a,instruments:l,depositTerm:n,bondType:o}=e;if(!t||!a||!l||0===l.length)throw Error("Missing required parameters");let i=await loadData(),r={};if(l.includes("inflation")){let e=findToolByCode(i,"inflation");e&&e.items&&"date"in e.items[0]&&(r.inflation=filterDataByDates(e.items,t,a))}if(l.includes("deposits")){let e="deposit_ruble_1";switch(n){case"less_than_1_year":e="deposit_ruble_1";break;case"1_to_3_years":e="deposit_ruble_1_3";break;case"more_than_3_years":e="deposit_ruble_3"}let l=findToolByCode(i,e);l&&l.items&&"date"in l.items[0]&&(r.deposits=filterDataByDates(l.items,t,a))}if(l.includes("bonds")){let e="bonds_ofz";switch(o){case"ofz":case"municipal":e="bonds_ofz";break;case"corporate":e="bonds_corporate"}let l=findToolByCode(i,e);l&&l.items&&"date"in l.items[0]&&(r.bonds=filterDataByDates(l.items,t,a))}if(l.includes("stocks")){let e=findToolByCode(i,"stock");e&&e.items&&"date"in e.items[0]&&(r.stocks=filterDataByDates(e.items,t,a))}return r}catch(e){throw console.error("Error fetching profitability data:",e),e}},formatDateForApi=e=>{let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(l)},parseApiDate=e=>{let[t,a,l]=e.split(".");return new Date(parseInt(l),parseInt(a)-1,parseInt(t))},calculateDepositProfitability=(e,t)=>{if(!t||0===t.length)return{finalAmount:e,profit:0,profitPercentage:0,monthlyData:[]};console.log("\uD83D\uDCB3 Deposit calculation input:",{amount:e,dataLength:t.length});let a=[...t].sort((e,t)=>parseApiDate(e.date).getTime()-parseApiDate(t.date).getTime());console.log("\uD83D\uDCB3 Sorted deposit data sample:",a.slice(0,5));let l=e,n=[];a.forEach((t,a)=>{let o=parseApiDate(t.date),i="".concat(o.getFullYear(),"-").concat((o.getMonth()+1).toString().padStart(2,"0")),r=t.value/100/12;l*=1+r;let s=(l-e)/e*100;n.push({month:i,cumulativeReturn:s,value:t.value})});let o=l,i=o-e,r=i/e*100;return console.log("\uD83D\uDCB3 Deposit calculation:",{finalAmount:o,profit:i,profitPercentage:r,monthlyDataLength:n.length}),{finalAmount:o,profit:i,profitPercentage:r,monthlyData:n}},calculateBondProfitability=(e,t)=>{if(!t||t.length<2)return{finalAmount:e,profit:0,profitPercentage:0,monthlyData:[]};console.log("\uD83D\uDCC8 Bond calculation input:",{amount:e,dataLength:t.length});let a=[...t].sort((e,t)=>parseApiDate(e.date).getTime()-parseApiDate(t.date).getTime());console.log("\uD83D\uDCC8 Bond data sample:",{first:a[0],last:a[a.length-1],sample:a.slice(0,3)});let l=a[0].value,n=[];a.forEach((t,a)=>{let o=parseApiDate(t.date),i="".concat(o.getFullYear(),"-").concat((o.getMonth()+1).toString().padStart(2,"0")),r=t.value/l;n.push({month:i,cumulativeReturn:(e*r-e)/e*100,value:t.value})});let o=a[a.length-1].value,i=o/l,r=e*i,s=r-e,c=s/e*100;return console.log("\uD83D\uDCC8 Bond calculation:",{indexGrowth:i,finalAmount:r,profit:s,profitPercentage:c,monthlyDataLength:n.length}),{finalAmount:r,profit:s,profitPercentage:c,monthlyData:n}},calculateStockProfitability=(e,t)=>{if(!t||t.length<2)return{finalAmount:e,profit:0,profitPercentage:0,monthlyData:[]};console.log("\uD83D\uDCCA Stock calculation input:",{amount:e,dataLength:t.length});let a=[...t].sort((e,t)=>parseApiDate(e.date).getTime()-parseApiDate(t.date).getTime());console.log("\uD83D\uDCCA Stock data sample:",{first:a[0],last:a[a.length-1],sample:a.slice(0,3)});let l=a[0].value,n=[];a.forEach((t,a)=>{let o=parseApiDate(t.date),i="".concat(o.getFullYear(),"-").concat((o.getMonth()+1).toString().padStart(2,"0")),r=t.value/l;n.push({month:i,cumulativeReturn:(e*r-e)/e*100,value:t.value})});let o=a[a.length-1].value,i=o/l,r=e*i,s=r-e,c=s/e*100;return console.log("\uD83D\uDCCA Stock calculation:",{indexGrowth:i,finalAmount:r,profit:s,profitPercentage:c,monthlyDataLength:n.length}),{finalAmount:r,profit:s,profitPercentage:c,monthlyData:n}},calculateInflationAdjustedProfitability=(e,t)=>{var a,l;if(!t||0===t.length)return e;console.log("\uD83D\uDCB9 Inflation adjustment calculation:",{profitPercentage:e,inflationDataLength:t.length,inflationSample:t.slice(0,3),inflationPeriod:(null===(a=t[0])||void 0===a?void 0:a.date)+" - "+(null===(l=t[t.length-1])||void 0===l?void 0:l.date)});let n=1;for(let e of t)n*=1+e.value;let o=(1+e/100)/n-1,i=100*o;return console.log("\uD83D\uDCB9 Inflation adjustment result:",{totalInflation:n.toFixed(4),totalInflationPercent:((n-1)*100).toFixed(2)+"%",nominalReturn:e.toFixed(2)+"%",realReturn:i.toFixed(2)+"%",periodUsed:t.length+" months"}),i},formatAmount=e=>{let t=e.replace(/[^\d]/g,"");if(""===t)return"";let a=parseInt(t);return a.toLocaleString("ru-RU")},validateAmount=e=>{let t=e.replace(/[^\d]/g,""),a=parseInt(t)||0;return 0===a?"Укажите сумму вложений":a<1e3?"Минимальная сумма 1 000 ₽":a>1e8?"Максимальная сумма 100 000 000 ₽":void 0},validateDates=(e,t)=>{let a={};if(e||(a.startDate="Выберите начальную дату периода"),t||(a.endDate="Выберите конечную дату периода"),e&&t){e>=t&&(a.endDate="Конечная дата должна быть больше начальной");let l=(t.getFullYear()-e.getFullYear())*12+(t.getMonth()-e.getMonth());l<1&&(a.endDate="Минимальный период 1 месяц"),l>360&&(a.endDate="Максимальный период 30 лет")}return a},useProfitabilityCalculator=()=>{let[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(!1),[o,i]=(0,n.useState)(null),[r,s]=(0,n.useState)([]),[c,d]=(0,n.useState)(formatAmount("1000000")),[p,u]=(0,n.useState)(new Date(2024,5,1)),[x,m]=(0,n.useState)(new Date(2025,4,1)),[h,g]=(0,n.useState)(!1),[f,b]=(0,n.useState)("less_than_1_year"),[D,v]=(0,n.useState)("ofz"),[y,j]=(0,n.useState)(!0),[_,w]=(0,n.useState)(!1),[k,N]=(0,n.useState)(!1),[C,F]=(0,n.useState)({});return(0,n.useEffect)(()=>{let e=validateDates(p,x);F(t=>({...t,startDate:e.startDate,endDate:e.endDate}))},[p,x]),(0,n.useEffect)(()=>{let calculateResults=async()=>{console.log("\uD83D\uDD04 Starting calculation...");let e=c.replace(/[^\d]/g,""),a=parseInt(e)||0;if(console.log("\uD83D\uDCB0 Amount:",a),console.log("\uD83D\uDCC5 Dates:",{startDate:p,endDate:x}),console.log("\uD83C\uDFAF Selected instruments:",{depositsChecked:y,bondsChecked:_,stocksChecked:k,inflationEnabled:h}),0===a||!p||!x){console.log("❌ Missing data, clearing results"),t([]);return}let n=validateDates(p,x);if(n.startDate||n.endDate){console.log("❌ Date validation errors:",n),t([]);return}console.log("⏳ Setting loading to true"),l(!0);try{var o,i,r,d,u,m,g,b;let e=[];if(y&&e.push("deposits"),_&&e.push("bonds"),k&&e.push("stocks"),h&&e.push("inflation"),console.log("\uD83D\uDCE6 Instruments to load:",e),0===e.length){console.log("❌ No instruments selected"),t([]),l(!1);return}let n={startDate:formatDateForApi(p),endDate:formatDateForApi(x),instruments:e,depositTerm:f,bondType:D};console.log("\uD83D\uDCE1 Fetching data with request:",n),console.log("\uD83D\uDDD3️ Actual dates used:",{startDateObject:null==p?void 0:p.toISOString(),endDateObject:null==x?void 0:x.toISOString(),startDateFormatted:formatDateForApi(p),endDateFormatted:formatDateForApi(x)});let c=await fetchProfitabilityData(n);console.log("\uD83D\uDCCA Received data:",{inflation:(null===(o=c.inflation)||void 0===o?void 0:o.length)||0,deposits:(null===(i=c.deposits)||void 0===i?void 0:i.length)||0,bonds:(null===(r=c.bonds)||void 0===r?void 0:r.length)||0,stocks:(null===(d=c.stocks)||void 0===d?void 0:d.length)||0}),(null===(u=c.deposits)||void 0===u?void 0:u.length)&&console.log("\uD83D\uDCB3 Deposits data sample:",c.deposits.slice(0,3)),(null===(m=c.bonds)||void 0===m?void 0:m.length)&&console.log("\uD83D\uDCC8 Bonds data sample:",c.bonds.slice(0,3)),(null===(g=c.stocks)||void 0===g?void 0:g.length)&&console.log("\uD83D\uDCCA Stocks data sample:",c.stocks.slice(0,3)),(null===(b=c.inflation)||void 0===b?void 0:b.length)&&console.log("\uD83D\uDCB9 Inflation data sample:",c.inflation.slice(0,3));let v=[],j=[];if(y&&c.deposits){let e;console.log("\uD83D\uDD22 Calculating deposits...");let t=calculateDepositProfitability(a,c.deposits);console.log("\uD83D\uDCB3 Deposit calculation result:",t),h&&c.inflation&&(e=calculateInflationAdjustedProfitability(t.profitPercentage,c.inflation),console.log("\uD83D\uDCB9 Inflation adjusted profit:",e)),v.push({instrument:"Депозит",finalAmount:t.finalAmount,profit:t.profit,profitPercentage:t.profitPercentage,inflationAdjustedProfit:e,monthlyData:t.monthlyData})}if(_&&c.bonds){let e;console.log("\uD83D\uDD22 Calculating bonds...");let t=calculateBondProfitability(a,c.bonds);console.log("\uD83D\uDCC8 Bond calculation result:",t),h&&c.inflation&&(e=calculateInflationAdjustedProfitability(t.profitPercentage,c.inflation)),v.push({instrument:"Облигации",finalAmount:t.finalAmount,profit:t.profit,profitPercentage:t.profitPercentage,inflationAdjustedProfit:e,monthlyData:t.monthlyData})}if(k&&c.stocks){let e;console.log("\uD83D\uDD22 Calculating stocks...");let t=calculateStockProfitability(a,c.stocks);console.log("\uD83D\uDCCA Stock calculation result:",t),h&&c.inflation&&(e=calculateInflationAdjustedProfitability(t.profitPercentage,c.inflation)),v.push({instrument:"Акции",finalAmount:t.finalAmount,profit:t.profit,profitPercentage:t.profitPercentage,inflationAdjustedProfit:e,monthlyData:t.monthlyData})}if(v.length>0&&v[0].monthlyData){let e=v[0].monthlyData.map(e=>e.month);j=e.map((e,t)=>{let a={month:e};return v.forEach(l=>{if(l.monthlyData){let n=l.monthlyData.find(t=>t.month===e);if(n&&(a[l.instrument]=n.cumulativeReturn,h&&void 0!==l.inflationAdjustedProfit&&c.inflation)){let o=1;for(let e=0;e<=t&&e<c.inflation.length;e++)o*=1+c.inflation[e].value;let i=n.cumulativeReturn/100,r=(1+i)/o-1,s=100*r;t<3&&console.log("\uD83D\uDCCA Chart inflation calc for ".concat(e,":"),{monthIndex:t,nominalReturn:n.cumulativeReturn.toFixed(2)+"%",cumulativeInflation:o.toFixed(4),realReturn:s.toFixed(2)+"%"}),a["".concat(l.instrument,"_inflation")]=s}}}),a})}console.log("✅ Final results:",v),console.log("\uD83D\uDCCA Chart data:",j.slice(0,3)),t(v),s(j)}catch(e){console.error("❌ Error calculating profitability:",e),t([])}finally{console.log("⏹ Setting loading to false"),l(!1)}};calculateResults()},[c,p,x,y,_,k,f,D,h]),{results:e,isLoading:a,error:o,monthlyChartData:r,amount:c,startDate:p,endDate:x,errors:C,inflationEnabled:h,setInflationEnabled:g,depositTerm:f,setDepositTerm:b,bondType:D,setBondType:v,depositsChecked:y,setDepositsChecked:j,bondsChecked:_,setBondsChecked:w,stocksChecked:k,setStocksChecked:N,setAmount:e=>{let t=e.replace(/[^\d]/g,"");d(formatAmount(t)),F(e=>({...e,amount:validateAmount(t)}))},setDateRange:(e,t)=>{u(e),m(t);let a=validateDates(e,t);F(e=>({...e,startDate:a.startDate,endDate:a.endDate}))},formatNumber:e=>Math.round(e).toLocaleString("ru-RU")}};function ProfitabilityPage(){let{amount:e,startDate:t,endDate:a,errors:o,isLoading:r,inflationEnabled:d,setInflationEnabled:p,depositTerm:u,setDepositTerm:x,bondType:m,setBondType:h,depositsChecked:g,setDepositsChecked:f,bondsChecked:b,setBondsChecked:D,stocksChecked:v,setStocksChecked:y,results:j,monthlyChartData:_,setAmount:w,setDateRange:k,formatNumber:N}=useProfitabilityCalculator();n.useRef(null);let[C,F]=(0,n.useState)(!1);return(0,l.jsxs)(c.Z,{children:[(0,l.jsxs)(i(),{children:[(0,l.jsx)("title",{children:"Калькулятор доходности"}),(0,l.jsx)("meta",{name:"description",content:"Позволяет оценить, сколько вы могли бы заработать, если бы вложились в разные виды активов в прошлом. Сравнивая доходность, не забывайте, что такая же прибыльность в будущем не гарантирована."})]}),(0,l.jsx)("div",{className:"min-h-screen",style:{backgroundColor:"#7880FF"},children:(0,l.jsxs)("div",{className:"relative py-8 md:py-10 lg:py-10 laptop:py-12 px-4 max-w-container mx-auto lg:scale-90 lg:origin-top",children:[(0,l.jsxs)("div",{className:"block md:grid md:grid-cols-2 lg:grid-cols-12 gap-4 md:gap-6 lg:gap-8",children:[(0,l.jsxs)("div",{className:"lg:col-span-5",children:[(0,l.jsx)("div",{className:"inline-flex items-center px-[30px] py-[5px] text-white text-subhead rounded-[30px]",style:{backgroundColor:"#101568"},children:"Бесплатный и понятный"}),(0,l.jsxs)("h1",{className:"text-head text-white mt-1.5 md:mt-2.5 leading-tight md:leading-normal",children:["ИСПОЛЬЗУЙ НАШ",(0,l.jsx)("br",{}),"КАЛЬКУЛЯТОР ДОХОДНОСТИ"]}),(0,l.jsx)("p",{className:"text-subhead text-white/80 mt-1.5 md:mt-6 lg:mt-10 mb-12 md:mb-16 lg:mb-0",children:"Позволяет оценить, сколько вы могли бы заработать, если бы вложились в разные виды активов в прошлом. Сравнивая доходность, не забывайте, что такая же прибыльность в будущем не гарантирована."})]}),(0,l.jsx)("div",{className:"hidden md:block lg:col-span-7 relative h-[300px] md:h-[400px]",children:(0,l.jsx)(s(),{src:"/img/calc.png",alt:"Калькулятор доходности",fill:!0,style:{objectFit:"contain",objectPosition:"right center"},priority:!0})})]}),(0,l.jsx)("div",{className:"relative mt-4 md:mt-0 lg:-mt-8",children:(0,l.jsxs)("div",{className:"relative z-10",children:[(0,l.jsx)("div",{className:"bg-white rounded-[30px] shadow-lg max-w-container mx-auto",children:(0,l.jsx)("div",{className:"max-w-container mx-auto px-6 md:px-10 lg:px-9 laptop:px-[60px] py-12 md:py-16 lg:py-14 laptop:py-[80px]",children:(0,l.jsxs)("form",{className:"space-y-20",children:[(0,l.jsxs)("div",{className:"grid gap-4 md:gap-6 lg:gap-11 laptop:gap-[70px] grid-cols-1 sm:grid-cols-2 xl:grid-cols-3",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"block text-label text-gray-700 pl-10",children:"Сумма вложений, ₽"}),(0,l.jsx)("input",{type:"text",value:e,onChange:e=>w(e.target.value),className:"w-full h-[60px] pl-10 rounded-[30px] bg-[#E9F5FF] border-0 focus:ring-2 focus:ring-accent-blue text-[22px]"}),o.amount&&(0,l.jsx)("div",{className:"text-red-500 text-sm pl-10",children:o.amount})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"block text-label text-gray-700 pl-10",children:"Период"}),(0,l.jsx)(components_DateRangePicker,{startDate:t,endDate:a,onChange:k,error:o.startDate||o.endDate}),(o.startDate||o.endDate)&&(0,l.jsx)("div",{className:"text-red-500 text-sm pl-10",children:o.startDate||o.endDate})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"block text-label text-gray-700 pl-10",children:"Учет инфляции"}),(0,l.jsx)(components_InflationSelect,{value:d,onChange:p})]})]}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)("h3",{className:"text-[20px] font-semibold text-gray-900",children:"Выберите инструменты"}),(0,l.jsxs)("div",{className:"grid gap-x-4 gap-y-2 md:gap-x-6 md:gap-y-3 lg:gap-x-8 lg:gap-y-4 grid-cols-1 sm:grid-cols-2 xl:grid-cols-3",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"block text-label text-gray-700 pl-10",children:"\xa0"}),(0,l.jsx)(components_CustomCheckbox,{checked:g,onChange:f,label:"Депозиты"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"block text-label text-gray-700 pl-10",children:"Срок депозита"}),(0,l.jsx)(components_DepositTermSelect,{value:u,onChange:x,disabled:!g})]}),(0,l.jsx)("div",{className:"hidden xl:block"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"block text-label text-gray-700 pl-10",children:"\xa0"}),(0,l.jsx)(components_CustomCheckbox,{checked:b,onChange:D,label:"Облигации"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"block text-label text-gray-700 pl-10",children:"Вид облигаций"}),(0,l.jsx)(components_BondTypeSelect,{value:m,onChange:h,disabled:!b})]}),(0,l.jsx)("div",{className:"hidden xl:block"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{className:"block text-label text-gray-700 pl-10",children:"\xa0"}),(0,l.jsx)(components_CustomCheckbox,{checked:v,onChange:y,label:"Акции"})]})]})]})]})})}),r&&(0,l.jsx)("div",{className:"text-white rounded-[30px] max-w-container mx-auto",style:{backgroundColor:"#101568"},children:(0,l.jsx)("div",{className:"max-w-container mx-auto px-6 md:px-10 lg:px-9 laptop:px-[60px] py-6 md:py-8 lg:py-6 laptop:py-[30px]",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-[18px] font-medium opacity-80",children:"Загружаем данные..."}),(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-white"})})]})})}),!r&&j.length>0&&(0,l.jsx)("div",{children:j.map((e,t)=>(0,l.jsx)("div",{className:"text-white rounded-[30px] max-w-container mx-auto",style:{backgroundColor:"#101568"},children:(0,l.jsx)("div",{className:"max-w-container mx-auto px-6 md:px-10 lg:px-9 laptop:px-[60px] py-6 md:py-8 lg:py-6 laptop:py-[30px]",children:(0,l.jsxs)("div",{className:"grid gap-4 md:gap-6 lg:gap-8 laptop:gap-[50px] grid-cols-1 sm:grid-cols-2 ".concat(d?"md:grid-cols-5":"md:grid-cols-4"),children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("div",{className:"text-[18px] font-medium opacity-80 whitespace-nowrap",children:"Инструмент"}),(0,l.jsx)("div",{className:"text-[28px] font-semibold whitespace-nowrap",children:e.instrument})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("div",{className:"text-[18px] font-medium opacity-80 whitespace-nowrap",children:"Сумма в конце срока"}),(0,l.jsxs)("div",{className:"text-[28px] font-semibold whitespace-nowrap",children:[N(e.finalAmount)," ₽"]})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("div",{className:"text-[18px] font-medium opacity-80 whitespace-nowrap",children:"Доход"}),(0,l.jsxs)("div",{className:"text-[28px] font-semibold whitespace-nowrap",children:[N(e.profit)," ₽"]})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("div",{className:"text-[18px] font-medium opacity-80 whitespace-nowrap",children:"Доход, %"}),(0,l.jsxs)("div",{className:"text-[28px] font-semibold whitespace-nowrap",children:[e.profitPercentage.toFixed(2)," %"]})]}),d&&void 0!==e.inflationAdjustedProfit&&(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("div",{className:"text-[18px] font-medium opacity-80 whitespace-nowrap",children:"Реальный доход, %"}),(0,l.jsxs)("div",{className:"text-[28px] font-semibold whitespace-nowrap",children:[e.inflationAdjustedProfit.toFixed(2)," %"]})]})]})})},t))}),!r&&j.length>0&&(0,l.jsx)(components_ProfitabilityChart,{results:j,inflationEnabled:d,startDate:t,endDate:a,monthlyChartData:_})]})})]})})]})}}},function(e){e.O(0,[342,644,850,675,793,659,770,192,68,774,888,179],function(){return e(e.s=518)}),_N_E=e.O()}]);